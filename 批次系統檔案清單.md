# 批次硬體比較系統 - 檔案清單

## ✅ 已創建的檔案

### 核心系統檔案

| 檔案名稱 | 類型 | 用途 | 重要性 |
|---------|------|------|--------|
| `batch_hardware_comparison.py` | 主腳本 | 批次執行所有實驗的核心腳本 | ⭐⭐⭐⭐⭐ |
| `hardware_multiple_spin_probit_annealing.py` | 演算法 | 硬體模擬的 Probit 演算法（已修改支援批次） | ⭐⭐⭐⭐⭐ |

### 測試與預覽工具

| 檔案名稱 | 類型 | 用途 | 重要性 |
|---------|------|------|--------|
| `test_batch_hardware.py` | 測試腳本 | 快速測試系統（G1~G3，約 5 分鐘） | ⭐⭐⭐⭐ |
| `preview_batch_hardware.py` | 預覽工具 | Dry-run 模式預覽所有命令 | ⭐⭐⭐ |

### 文檔說明

| 檔案名稱 | 類型 | 用途 | 重要性 |
|---------|------|------|--------|
| `QUICK_START.md` | 快速指南 | 3 分鐘快速開始指南 | ⭐⭐⭐⭐⭐ |
| `批量硬體比較使用說明.md` | 詳細說明 | 完整的使用說明和參數文檔 | ⭐⭐⭐⭐ |
| `BATCH_HARDWARE_README.md` | 系統總覽 | 系統架構和進階用法 | ⭐⭐⭐⭐ |
| `批次系統檔案清單.md` | 檔案清單 | 本文件，列出所有相關檔案 | ⭐⭐⭐ |

## 📁 系統架構

```
批次硬體比較系統/
│
├── 核心程式
│   ├── batch_hardware_comparison.py        (批次執行腳本)
│   └── hardware_multiple_spin_probit_annealing.py  (演算法實現)
│
├── 測試工具
│   ├── test_batch_hardware.py              (快速測試)
│   └── preview_batch_hardware.py           (執行預覽)
│
├── 文檔
│   ├── QUICK_START.md                      (快速開始)
│   ├── 批量硬體比較使用說明.md              (詳細說明)
│   ├── BATCH_HARDWARE_README.md            (系統總覽)
│   └── 批次系統檔案清單.md                  (本文件)
│
└── 輸出結果
    └── hardware_comparison_results/        (所有實驗結果)
        ├── trial100_steps1000/
        ├── trial100_steps10000/
        ├── trial1000_steps100/
        └── trial1000_steps10000/
```

## 🚀 推薦使用流程

### 第一次使用

1. **閱讀快速指南**
   ```bash
   cat QUICK_START.md
   ```

2. **預覽執行計劃**
   ```bash
   python preview_batch_hardware.py --start 1 --end 3
   ```

3. **快速測試**
   ```bash
   python test_batch_hardware.py
   ```

4. **查看測試結果**
   ```bash
   ls -lh hardware_comparison_results/*/
   ```

5. **確認無誤後執行完整測試**
   ```bash
   nohup python batch_hardware_comparison.py > batch_log.txt 2>&1 &
   ```

### 日常使用

1. **直接執行**
   ```bash
   python batch_hardware_comparison.py
   ```

2. **部分執行**
   ```bash
   python batch_hardware_comparison.py --start_graph 1 --end_graph 20
   ```

3. **自定義參數**
   ```bash
   python batch_hardware_comparison.py --sigma_start 10.0 --epsilon 0.2
   ```

## 📝 各檔案詳細說明

### 1. batch_hardware_comparison.py

**功能**：批次執行核心腳本

**主要特性**：
- 自動遍歷 G1~G81 所有圖檔
- 測試 4 種參數組合（trial × timestep）
- 結果自動分類存儲
- 顯示即時進度和統計
- 支援 dry-run 模式
- 完整的錯誤處理和日誌

**關鍵參數**：
- `--start_graph`: 起始圖檔編號（預設 1）
- `--end_graph`: 結束圖檔編號（預設 81）
- `--graph_dir`: 圖檔目錄（預設 `./graph`）
- `--dry_run`: 僅預覽，不執行

**輸出**：
- 結果存到 `hardware_comparison_results/` 的 4 個子資料夾
- 終端顯示即時進度
- 完成後顯示統計摘要

### 2. hardware_multiple_spin_probit_annealing.py

**功能**：硬體 Probit 類比退火演算法（已修改）

**主要修改**：
- 新增環境變數支援：`HARDWARE_OUTPUT_DIR`
- 新增硬體非同步函數：`probit_annealing_hardware_asynchronous`
- 保留原有的同步函數：`probit_fitting_hardware_synchronous`

**關鍵函數**：
- `probit_fitting_hardware_synchronous`: Binary spin + RPA 策略
- `probit_annealing_hardware_asynchronous`: Ising spin + MCS 策略
- `traditional_sa`: 傳統 Metropolis-Hastings SA
- `calculate_energy`: 能量計算
- `calculate_cut`: Cut 值計算

**硬體模擬**：
- Crossbar 權重：{0, 0.5, 1}
- MVM 修正電路：數位還原理想本地場
- 支援同步（RPA）和非同步（MCS）模式

### 3. test_batch_hardware.py

**功能**：快速測試腳本

**測試範圍**：
- G1~G3（3 個圖）
- 4 種參數組合
- 共 12 個實驗

**執行時間**：約 5-10 分鐘

**用途**：
- 驗證系統是否正常運作
- 確認環境設定正確
- 檢查輸出格式

### 4. preview_batch_hardware.py

**功能**：執行計劃預覽工具

**特性**：
- Dry-run 模式（不實際執行）
- 顯示所有要執行的命令
- 計算總實驗數
- 預估執行時間

**用途**：
- 確認參數設定
- 檢查命令格式
- 規劃執行策略

### 5. QUICK_START.md

**功能**：3 分鐘快速開始指南

**內容**：
- 最精簡的使用步驟
- 常用命令
- 問題排除
- 快速測試清單

**適合對象**：
- 首次使用者
- 需要快速上手
- 不想看長篇文檔

### 6. 批量硬體比較使用說明.md

**功能**：完整的使用說明

**內容**：
- 詳細的參數說明
- 所有命令選項
- 輸出檔案說明
- 常見問題解答
- 執行時間估算
- 結果分析方法

**適合對象**：
- 需要了解所有功能
- 需要自定義參數
- 需要深入理解系統

### 7. BATCH_HARDWARE_README.md

**功能**：系統總覽和進階用法

**內容**：
- 系統架構說明
- 技術細節
- 進階用法
- 修改指南
- 平行執行建議
- 結果統計分析

**適合對象**：
- 需要修改系統
- 需要了解實現細節
- 需要擴展功能

## 🔄 工作流程圖

```
開始
  │
  ├─→ [第一次使用?]
  │   │
  │   yes → 閱讀 QUICK_START.md
  │   │     │
  │   │     ├─→ 執行 preview_batch_hardware.py (預覽)
  │   │     │
  │   │     ├─→ 執行 test_batch_hardware.py (測試)
  │   │     │
  │   │     └─→ 檢查結果
  │   │
  │   no ─┐
  │       │
  ├───────┘
  │
  ├─→ 執行 batch_hardware_comparison.py
  │   │
  │   ├─→ [全部圖檔?]
  │   │   yes → python batch_hardware_comparison.py
  │   │   no  → python batch_hardware_comparison.py --start_graph X --end_graph Y
  │   │
  │   └─→ 等待完成（5-6 小時）
  │
  ├─→ 檢查結果
  │   │
  │   └─→ 查看 hardware_comparison_results/
  │
  └─→ 分析結果
      │
      ├─→ 查看 CSV 摘要
      ├─→ 查看 PNG 圖表
      └─→ 查看 Excel 詳細數據
```

## 📊 測試參數組合

| 組合 | Trial | Timestep | 目的 | 預期特性 |
|------|-------|----------|------|----------|
| 1 | 100 | 1,000 | 快速探索 | 快速，結果變異大 |
| 2 | 100 | 10,000 | 深度探索 | 較慢，單次品質高 |
| 3 | 1,000 | 100 | 廣度搜尋 | 較快，統計穩定 |
| 4 | 1,000 | 10,000 | 完整搜尋 | 最慢，最佳品質 |

## 💾 磁碟空間需求

| 範圍 | 實驗數 | 檔案數 | 空間需求 |
|------|--------|--------|----------|
| G1~G3 | 12 | 48 | ~20 MB |
| G1~G10 | 40 | 160 | ~100 MB |
| G1~G20 | 80 | 320 | ~300 MB |
| G1~G81 | 324 | 1,296 | ~1-2 GB |

## ⏱️ 執行時間估算

**假設**：平均每個實驗 1 分鐘（實際取決於圖檔大小和硬體）

| 範圍 | 實驗數 | 預計時間 | 建議執行方式 |
|------|--------|----------|--------------|
| G1~G3 | 12 | 10-15 分鐘 | 前台執行 |
| G1~G10 | 40 | 30-60 分鐘 | 前台或背景 |
| G1~G20 | 80 | 1-2 小時 | 背景執行 |
| G1~G81 | 324 | 5-6 小時 | 背景執行（nohup/screen） |

## 🎯 使用建議

### 初學者
1. 閱讀 `QUICK_START.md`
2. 執行 `test_batch_hardware.py`
3. 查看結果
4. 執行部分測試（如 G1~G10）

### 進階使用者
1. 直接執行 `batch_hardware_comparison.py`
2. 自定義參數
3. 修改參數組合（編輯 `configs`）
4. 分析結果

### 研究人員
1. 閱讀 `BATCH_HARDWARE_README.md`
2. 理解硬體模擬細節
3. 修改演算法（如需要）
4. 執行完整測試
5. 深度分析結果

## 🔧 自定義修改

### 修改參數組合

編輯 `batch_hardware_comparison.py`：

```python
def create_output_directories(base_dir='./hardware_comparison_results'):
    configs = [
        ('trial100_steps1000', 100, 1000),
        # 新增你的組合
        ('trial500_steps5000', 500, 5000),
    ]
```

### 修改輸出目錄

```bash
# 方法 1：修改腳本預設值
# 編輯 batch_hardware_comparison.py 的 base_dir 參數

# 方法 2：在執行前設置環境變數
export HARDWARE_OUTPUT_DIR=/path/to/output
python hardware_multiple_spin_probit_annealing.py ...
```

### 修改演算法參數

```bash
# 調整 sigma 範圍
python batch_hardware_comparison.py --sigma_start 10.0 --sigma_end 0.001

# 調整 RPA 更新比例
python batch_hardware_comparison.py --epsilon 0.2

# 使用線性退火
python batch_hardware_comparison.py --schedule linear

# 使用非同步模式
python batch_hardware_comparison.py --probit_mode asynchronous
```

## ✅ 檢查清單

### 執行前
- [ ] Python 3.7+ 已安裝
- [ ] 必要套件已安裝（numpy, pandas, matplotlib, openpyxl）
- [ ] 圖檔目錄存在且可訪問
- [ ] 磁碟空間足夠（至少 2 GB）
- [ ] 記憶體足夠（建議 8 GB+）

### 測試
- [ ] 單一實驗可以執行
- [ ] 預覽模式正常
- [ ] 快速測試通過
- [ ] 結果檔案正確生成

### 執行
- [ ] 選擇合適的圖檔範圍
- [ ] 選擇合適的執行方式（前台/背景）
- [ ] 設置日誌記錄
- [ ] 定期檢查進度

### 完成後
- [ ] 檢查失敗的實驗
- [ ] 驗證結果完整性
- [ ] 備份重要結果
- [ ] 分析和總結

## 📞 獲取幫助

1. **快速問題**：查看 `QUICK_START.md`
2. **參數問題**：查看 `批量硬體比較使用說明.md`
3. **技術細節**：查看 `BATCH_HARDWARE_README.md`
4. **演算法問題**：查看 `hardware_multiple_spin_probit_annealing.py` 頂部註解

## 📌 重要提示

1. **首次使用**：請先執行 `test_batch_hardware.py` 確認系統正常
2. **長時間執行**：使用 `nohup` 或 `screen` 在背景執行
3. **磁碟空間**：確保有足夠空間（完整測試需 1-2 GB）
4. **中斷恢復**：目前不支援，建議分段執行
5. **結果備份**：重要結果請及時備份

---

**版本**：v1.0  
**建立日期**：2025-01-13  
**最後更新**：2025-01-13

